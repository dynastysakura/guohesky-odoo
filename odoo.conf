[options]
addons_path = /mnt/extra-addons
data_dir = /var/lib/odoo

; ===================
; 数据库配置
; ===================
; db_host, db_user, db_password 由 Docker 环境变量自动注入
db_template = template0

; 生产环境安全：限制只能访问特定数据库
; 使用 %d 匹配子域名，如 odoo.guohesky.com 会匹配 "odoo" 数据库
; dbfilter = ^%d$

; 指定数据库名（配合 init 参数首次启动时自动创建）
db_name = odoo

; 生产安全：禁用数据库列表（配合 db_name 使用）
list_db = False

; 首次启动时初始化的模块（数据库存在后可注释掉）
init = base

; ===================
; 安全设置（重要！）
; ===================
; 数据库管理主密码 - 部署后务必修改！
; 官方推荐：用强密码保护数据库管理器，而非禁用
admin_passwd = CHANGE_ME_IMMEDIATELY

; ===================
; 反向代理配置
; ===================
proxy_mode = True
http_interface = 0.0.0.0

; ===================
; 生产环境配置
; ===================
without_demo = True

; ===================
; 日志配置
; ===================
; 不设置 logfile，默认输出到 stderr，由 Docker 收集
; 生产环境用 warn，调试时可改为 info 或 debug
log_level = warn

; ===================
; 多进程配置（官方文档推荐值）
; ===================
; 官方公式: workers = (CPU × 2) + 1
; 官方公式: 1 worker ≈ 6 并发用户
; 官方公式: RAM = workers × ((0.8 × 150MB) + (0.2 × 1024MB))
;
; Oracle Cloud ARM 3核18G 服务器:
; - 理论 workers = (3 × 2) + 1 = 7
; - 减去 1 个 cron = 6 个 HTTP workers
; - 预计支持 36+ 并发用户
; - 内存使用: 7 × 325MB ≈ 2.3GB，18GB 完全足够
workers = 6
max_cron_threads = 1

; 内存限制（针对 18GB 内存优化）
; soft: 超过后请求完成时重启 worker（正常回收）
; hard: 超过后立即杀死 worker（防止内存泄漏）
limit_memory_soft = 1073741824
limit_memory_hard = 2684354560

; 请求限制
limit_request = 8192
limit_time_cpu = 600
limit_time_real = 1200
